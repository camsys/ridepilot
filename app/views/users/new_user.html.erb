<div id="page-header">
  <h1>Create New User</h1>
</div>

<%= form_for @user, :url=>url_for(:action=>:create_user) do |f| %>
  <% if @user.errors.any? || @errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@user.errors.count + @errors.try(:count).try(:to_i), "error") %> prohibited this run from being saved:</h2>

      <ul>
      <% @user.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      <% @errors.each do |field, msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <fieldset>
    <ol class="section first">
      <li>
        <%= f.label :email, "Email:" %>
        <%= f.text_field :email %>
      </li>

      <li>
        <%= f.label :permissions, "Permissions:" %>
        <%= select :role, :level, Role.editable_role_array_by_user(current_user) %>
      </li>
    </ol>

    <div class="actions">
      <%= f.submit "Create User" %>
    </div>
  </fieldset>
<% end %>